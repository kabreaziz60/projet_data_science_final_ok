{% load static %}
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Support — Chatbot</title>
  <link rel="stylesheet" href="{% static 'support_bot/chat.css' %}">
</head>
<body>
  <div id="chat-widget" class="chat-closed" aria-live="polite">
    <div class="chat-header" id="chatHeader">
      <div class="brand">
        <img src="{% static 'support_bot/logo.png' %}" alt="Logo" class="brand-logo" onerror="this.style.display='none'">
        <div class="brand-title">
          <span class="title-main">SUPPORT TIC</span>
          <small class="title-sub">Assistance & Formation</small>
        </div>
      </div>
      <button id="chatToggle" class="toggle-btn" aria-expanded="false">▶</button>
    </div>

    <div class="chat-body" id="chatBody" hidden>
      <div class="chat-conversation" id="conversation" role="log"></div>

      <div class="quick-actions" id="quickActions">
        <button class="qa-btn">Dépannage PC</button>
        <button class="qa-btn">Installation logiciel</button>
        <button class="qa-btn">Accès Wi-Fi</button>
      </div>

      <form id="chatForm" class="chat-form" autocomplete="off">
        <input id="messageInput" class="chat-input" type="text" name="question" placeholder="Tapez votre question..." aria-label="Message">
        <button type="submit" class="send-btn">Envoyer</button>
      </form>

      <div class="small-print">Disponible : 7j/7 - 24h/24</div>
    </div>
  </div>

  <script>
    // récupère le token CSRF si nécessaire (prêt pour prod)
    function getCookie(name) {
      let v = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const c = cookies[i].trim();
          if (c.substring(0, name.length + 1) === (name + '=')) {
            v = decodeURIComponent(c.substring(name.length + 1));
            break;
          }
        }
      }
      return v;
    }
    const CSRFTOKEN = getCookie('csrftoken');
  </script>

  <script src="{% static 'support_bot/chat.js' %}"></script>
</body>
</html>
